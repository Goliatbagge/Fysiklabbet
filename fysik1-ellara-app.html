<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Elektriska kretsar - Fysiklabbet</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        .dark-container {
            background: linear-gradient(135deg, #0a0a1a 0%, #0d1526 50%, #0a1020 100%);
        }
        .glass-card {
            background: rgba(15, 23, 42, 0.8);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(56, 189, 248, 0.15);
        }
        .glass-card-light {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(148, 163, 184, 0.2);
        }
        .glow-text {
            text-shadow: 0 0 20px rgba(56, 189, 248, 0.5);
        }
        .btn-glow {
            box-shadow: 0 0 20px rgba(56, 189, 248, 0.3);
            transition: all 0.3s ease;
        }
        .btn-glow:hover {
            box-shadow: 0 0 30px rgba(56, 189, 248, 0.5);
        }
        .electron-glow {
            filter: drop-shadow(0 0 6px rgba(56, 189, 248, 0.8));
        }
        .wire-glow {
            filter: drop-shadow(0 0 3px rgba(56, 189, 248, 0.4));
        }
        .bulb-glow {
            filter: drop-shadow(0 0 15px rgba(250, 204, 21, 0.6));
        }
        .battery-clickable:hover .battery-pole {
            stroke: #67e8f9;
            filter: drop-shadow(0 0 6px rgba(56, 189, 248, 0.8));
        }
        .battery-clickable:hover text {
            filter: drop-shadow(0 0 4px currentColor);
        }
        .battery-clickable {
            transition: transform 0.1s ease;
        }
        .battery-clickable:active {
            transform: scale(0.95);
        }
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: linear-gradient(to right, #0ea5e9 0%, #0ea5e9 var(--progress, 50%), #1e293b var(--progress, 50%), #1e293b 100%);
            border-radius: 8px;
            height: 8px;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            cursor: pointer;
            box-shadow: 0 0 12px rgba(56, 189, 248, 0.6);
        }
        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: linear-gradient(135deg, #38bdf8, #0ea5e9);
            cursor: pointer;
            border: none;
            box-shadow: 0 0 12px rgba(56, 189, 248, 0.6);
        }
    </style>
</head>
<body class="bg-slate-950">
    <nav class="navbar">
        <div class="nav-container">
            <a href="index.html" class="logo">
                <span class="logo-icon">‚öõÔ∏è</span>
                <span class="logo-text">Fysiklabbet</span>
            </a>
            <ul class="nav-menu">
                <li><a href="index.html" class="nav-link">Hem</a></li>
                <li><a href="fysik1.html" class="nav-link active">Fysik 1</a></li>
                <li><a href="fysik2.html" class="nav-link">Fysik 2</a></li>
            </ul>
        </div>
    </nav>

    <main class="dark-container min-h-screen">
        <div id="root"></div>
    </main>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const CircuitType = {
          DC: 'dc',
          AC: 'ac',
        };

        // Constants for the SVG path
        const PATH_LENGTH = 1000;
        const TOP_WIRE_END = 300;
        const RIGHT_WIRE_END = 500;
        const BOTTOM_WIRE_END = 800;
        const NUM_ELECTRONS = 40;
        const NUM_ARROWS = 12;
        const AC_AMPLITUDE_FACTOR = 10;
        const ANIMATION_SPEED_FACTOR = 0.8;

        const getCoordsOnPath = (position) => {
          const p = position % PATH_LENGTH;

          if (p >= 0 && p < TOP_WIRE_END) {
            return { x: 50 + p, y: 50 };
          } else if (p >= TOP_WIRE_END && p < RIGHT_WIRE_END) {
            return { x: 350, y: 50 + (p - TOP_WIRE_END) };
          } else if (p >= RIGHT_WIRE_END && p < BOTTOM_WIRE_END) {
            return { x: 350 - (p - RIGHT_WIRE_END), y: 250 };
          } else {
            return { x: 50, y: 250 - (p - BOTTOM_WIRE_END) };
          }
        };

        const CircuitDiagram = ({ circuitType, showElectrons, showCurrentDirection, currentStrength, acFrequency, isPaused, isBulbBroken, batteryFlipped, onBatteryClick }) => {
          const [electrons, setElectrons] = useState([]);
          const [arrows, setArrows] = useState([]);
          const animationFrameId = useRef(null);
          const dcPositionOffset = useRef(0);
          const dcArrowPositionOffset = useRef(0);
          const currentStrengthRef = useRef(currentStrength);
          const isPausedRef = useRef(isPaused);
          const isBulbBrokenRef = useRef(isBulbBroken);
          const batteryFlippedRef = useRef(batteryFlipped);
          const animateRef = useRef(null);

          useEffect(() => {
            currentStrengthRef.current = currentStrength;
          }, [currentStrength]);

          useEffect(() => {
            isPausedRef.current = isPaused;
            if (!isPaused && animationFrameId.current === null && animateRef.current) {
                animationFrameId.current = requestAnimationFrame(animateRef.current);
            }
          }, [isPaused]);

          useEffect(() => {
            isBulbBrokenRef.current = isBulbBroken;
          }, [isBulbBroken]);

          useEffect(() => {
            batteryFlippedRef.current = batteryFlipped;
          }, [batteryFlipped]);

          useEffect(() => {
            const initialElectrons = [];
            for (let i = 0; i < NUM_ELECTRONS; i++) {
              initialElectrons.push({
                id: i,
                basePosition: (i * PATH_LENGTH) / NUM_ELECTRONS,
              });
            }
            setElectrons(initialElectrons);

            const initialArrows = [];
            for (let i = 0; i < NUM_ARROWS; i++) {
                initialArrows.push({
                    id: i,
                    basePosition: (i * PATH_LENGTH) / NUM_ARROWS,
                });
            }
            setArrows(initialArrows);

            dcPositionOffset.current = 0;
            dcArrowPositionOffset.current = 0;

            const animate = (timestamp) => {
              if (isPausedRef.current) {
                animationFrameId.current = null;
                return;
              }

              // Stop animation if bulb is broken
              if (circuitType === CircuitType.DC && !isBulbBrokenRef.current) {
                const animationStep = currentStrengthRef.current * ANIMATION_SPEED_FACTOR;
                // Reverse direction if battery is flipped
                const direction = batteryFlippedRef.current ? 1 : -1;
                dcPositionOffset.current = (dcPositionOffset.current + direction * animationStep) % PATH_LENGTH;
                dcArrowPositionOffset.current = (dcArrowPositionOffset.current - direction * animationStep) % PATH_LENGTH;
              }

              setElectrons(prev => [...prev]);

              animationFrameId.current = requestAnimationFrame(animate);
            };

            animateRef.current = animate;

            if (!isPausedRef.current) {
                animationFrameId.current = requestAnimationFrame(animate);
            }

            return () => {
              if (animationFrameId.current) {
                cancelAnimationFrame(animationFrameId.current);
              }
            };
          }, [circuitType]);

          const acAnimationFrequencyFactor = (2 * Math.PI * acFrequency) / 1000;

          // Handler for battery click - defined at component level
          const handleBatteryClick = (e) => {
            e.stopPropagation();
            if (onBatteryClick) {
              onBatteryClick();
            }
          };

          // Swedish standard symbol: circle with X
          const Bulb = () => {
            const glowIntensity = isBulbBroken ? 0 : Math.max(0, Math.min(currentStrength / 2, 1));
            const glowColor = isBulbBroken ? '#64748b' : (glowIntensity > 0.1 ? '#fbbf24' : '#38bdf8');

            if (isBulbBroken) {
              return (
                <g>
                  {/* Smoke/burnt effect */}
                  <ellipse cx="350" cy="130" rx="12" ry="20" fill="#475569" opacity="0.3" style={{ filter: 'blur(8px)' }} />
                  {/* Background circle to hide wire */}
                  <circle
                    cx="350" cy="150" r="17"
                    fill="#050510"
                  />
                  {/* Broken circle with cracks */}
                  <circle
                    cx="350" cy="150" r="18"
                    fill="none"
                    stroke="#64748b"
                    strokeWidth="2.5"
                    strokeDasharray="8 4"
                  />
                  {/* Broken X - jagged lines */}
                  <path
                    d="M 337 137 L 348 148 M 352 152 L 363 163"
                    stroke="#64748b"
                    strokeWidth="2.5"
                    strokeLinecap="round"
                  />
                  <path
                    d="M 363 137 L 352 148 M 348 152 L 337 163"
                    stroke="#64748b"
                    strokeWidth="2.5"
                    strokeLinecap="round"
                  />
                  {/* Crack lines */}
                  <path
                    d="M 340 135 L 344 142 L 338 148"
                    stroke="#ef4444"
                    strokeWidth="1.5"
                    fill="none"
                    opacity="0.7"
                  />
                  <path
                    d="M 360 155 L 364 160 L 358 166"
                    stroke="#ef4444"
                    strokeWidth="1.5"
                    fill="none"
                    opacity="0.7"
                  />
                  {/* Burnt spot */}
                  <circle cx="350" cy="150" r="6" fill="#1e293b" opacity="0.5" />
                </g>
              );
            }

            // Background color transitions from dark to warm glow
            const bgColor = glowIntensity > 0.1
              ? `rgba(251, 191, 36, ${glowIntensity * 0.3})`
              : '#050510';

            return (
              <g>
                {/* Outer glow when lit */}
                <circle
                  cx="350" cy="150" r="28"
                  fill="#fef08a"
                  style={{ opacity: glowIntensity * 0.4, filter: 'blur(10px)' }}
                />
                {/* Background circle to hide wire - glows when lit */}
                <circle
                  cx="350" cy="150" r="17"
                  fill="#050510"
                />
                {/* Inner glow overlay */}
                {glowIntensity > 0.1 && (
                  <circle
                    cx="350" cy="150" r="16"
                    fill="#fbbf24"
                    style={{ opacity: glowIntensity * 0.4 }}
                  />
                )}
                {/* Circle */}
                <circle
                  cx="350" cy="150" r="18"
                  fill="none"
                  stroke={glowColor}
                  strokeWidth="2.5"
                  style={{ filter: glowIntensity > 0.3 ? 'drop-shadow(0 0 8px rgba(251, 191, 36, 0.6))' : 'none' }}
                />
                {/* X inside - diagonal lines */}
                <line
                  x1="337" y1="137" x2="363" y2="163"
                  stroke={glowColor}
                  strokeWidth="2.5"
                  strokeLinecap="round"
                />
                <line
                  x1="363" y1="137" x2="337" y2="163"
                  stroke={glowColor}
                  strokeWidth="2.5"
                  strokeLinecap="round"
                />
              </g>
            );
          };

          // Swedish standard symbol: rectangular box for resistor
          const Resistor = () => {
            const boxWidth = 50;
            const boxHeight = 20;
            const x = 200;  // Center of bottom wire
            const y = 250;

            return (
              <g>
                {/* Background to hide wire */}
                <rect
                  x={x - boxWidth/2 - 5}
                  y={y - 3}
                  width={boxWidth + 10}
                  height={6}
                  fill="#050510"
                />
                {/* Resistor box */}
                <rect
                  x={x - boxWidth/2}
                  y={y - boxHeight/2}
                  width={boxWidth}
                  height={boxHeight}
                  fill="none"
                  stroke="#38bdf8"
                  strokeWidth="2.5"
                  rx="2"
                />
                {/* Connection lines (already part of main wire, just for visual clarity) */}
                <line
                  x1={x - boxWidth/2}
                  y1={y}
                  x2={x - boxWidth/2 - 5}
                  y2={y}
                  stroke="#38bdf8"
                  strokeWidth="2"
                />
                <line
                  x1={x + boxWidth/2}
                  y1={y}
                  x2={x + boxWidth/2 + 5}
                  y2={y}
                  stroke="#38bdf8"
                  strokeWidth="2"
                />
                {/* R label */}
                <text
                  x={x}
                  y={y + 1}
                  textAnchor="middle"
                  dominantBaseline="middle"
                  fill="#38bdf8"
                  fontSize="14px"
                  fontWeight="bold"
                  fontStyle="italic"
                >
                  R
                </text>
              </g>
            );
          };

          // Swedish standard symbol: horizontal lines perpendicular to wire (long = +, short = -)
          const PowerSource = () => {
              if (circuitType === CircuitType.DC) {
                  // When battery is flipped, swap the positions of + and -
                  const topY = 140;
                  const bottomY = 160;
                  const longLineY = batteryFlipped ? bottomY : topY;
                  const shortLineY = batteryFlipped ? topY : bottomY;
                  const plusY = batteryFlipped ? bottomY + 4 : topY + 4;
                  const minusY = batteryFlipped ? topY + 4 : bottomY + 4;

                  return (
                      <g
                        style={{ cursor: 'pointer', pointerEvents: 'all' }}
                        className="battery-clickable"
                        onPointerDown={(e) => { e.stopPropagation(); onBatteryClick && onBatteryClick(); }}
                      >
                          {/* Invisible larger hit area for easier clicking */}
                          <rect
                            x="20" y="130" width="60" height="40"
                            fill="rgba(0,0,0,0.01)"
                            style={{ pointerEvents: 'all' }}
                          />
                          {/* Gap in wire - cover the wire between terminals */}
                          <line x1="50" y1="135" x2="50" y2="165" stroke="#050510" strokeWidth="8" />
                          {/* Long horizontal line (positive terminal) */}
                          <line
                            className="battery-pole"
                            x1="30" y1={longLineY} x2="70" y2={longLineY}
                            stroke="#38bdf8"
                            strokeWidth="3"
                            strokeLinecap="round"
                          />
                          {/* Short horizontal line (negative terminal) */}
                          <line
                            className="battery-pole"
                            x1="38" y1={shortLineY} x2="62" y2={shortLineY}
                            stroke="#38bdf8"
                            strokeWidth="3"
                            strokeLinecap="round"
                          />
                          {/* Plus label */}
                          <text x="75" y={plusY} fill="#22c55e" fontSize="12px" fontWeight="bold">+</text>
                          {/* Minus label */}
                          <text x="66" y={minusY} fill="#ef4444" fontSize="12px" fontWeight="bold">‚àí</text>
                          {/* Hover hint */}
                          <title>Klicka f√∂r att v√§nda batteriet</title>
                      </g>
                  );
              } else {
                  // AC source: circles at terminals with tilde between
                  return (
                      <g>
                          {/* Gap in wire */}
                          <line x1="50" y1="120" x2="50" y2="180" stroke="#050510" strokeWidth="8" />
                          {/* Top terminal circle */}
                          <circle cx="50" cy="125" r="5" fill="none" stroke="#38bdf8" strokeWidth="2" />
                          {/* Bottom terminal circle */}
                          <circle cx="50" cy="175" r="5" fill="none" stroke="#38bdf8" strokeWidth="2" />
                          {/* Tilde - horizontal ~ */}
                          <path
                            d="M 35 150 Q 42 138, 50 150 Q 58 162, 65 150"
                            stroke="#38bdf8"
                            fill="none"
                            strokeWidth="2.5"
                            strokeLinecap="round"
                          />
                      </g>
                  )
              }
          };

          // Current direction arrows
          const ArrowShapes = () => (
            <>
              {arrows.map(arrow => {
                  const acAmplitude = currentStrength * AC_AMPLITUDE_FACTOR;
                  const posValue = arrow.basePosition + (circuitType === CircuitType.AC
                    ? -acAmplitude * Math.sin(performance.now() * acAnimationFrequencyFactor)
                    : dcArrowPositionOffset.current
                  );

                  const normalizedPos = ((posValue % PATH_LENGTH) + PATH_LENGTH) % PATH_LENGTH;

                  // Skip arrows near battery, bulb, and resistor
                  if (normalizedPos > 870 && normalizedPos < 930) return null;
                  if (normalizedPos > 370 && normalizedPos < 430) return null;
                  if (normalizedPos > 620 && normalizedPos < 680) return null;

                  const { x, y } = getCoordsOnPath(normalizedPos);
                  const { x: x2, y: y2 } = getCoordsOnPath(normalizedPos + 1);
                  let angle = Math.atan2(y2 - y, x2 - x) * (180 / Math.PI);

                  if (circuitType === CircuitType.AC) {
                    const velocityDirection = -Math.cos(performance.now() * acAnimationFrequencyFactor);
                    if (velocityDirection < 0) {
                      angle += 180;
                    }
                  } else if (batteryFlipped) {
                    // Flip arrow direction when battery is flipped
                    angle += 180;
                  }

                  return (
                    <path
                      key={`arrow-${arrow.id}`}
                      d="M-6 -4 L6 0 L-6 4 Z"
                      fill="#38bdf8"
                      opacity="0.95"
                      transform={`translate(${x} ${y}) rotate(${angle})`}
                      style={{ filter: 'drop-shadow(0 0 4px rgba(56, 189, 248, 0.6))' }}
                    />
                  );
              })}
            </>
          );

          // Glowing cyan electrons
          const ElectronDots = () => {
            return (
            <>
              {/* Glow filter definition */}
              <defs>
                <filter id="electronGlow" x="-50%" y="-50%" width="200%" height="200%">
                  <feGaussianBlur stdDeviation="2" result="blur" />
                  <feMerge>
                    <feMergeNode in="blur" />
                    <feMergeNode in="SourceGraphic" />
                  </feMerge>
                </filter>
              </defs>
              {electrons.map(electron => {
                  // Freeze electrons when bulb is broken
                  const acAmplitude = isBulbBroken ? 0 : currentStrength * AC_AMPLITUDE_FACTOR;
                  const posValue = electron.basePosition + (isBulbBroken
                    ? 0
                    : (circuitType === CircuitType.AC
                      ? acAmplitude * Math.sin(performance.now() * acAnimationFrequencyFactor)
                      : dcPositionOffset.current)
                  );

                  const normalizedPos = ((posValue % PATH_LENGTH) + PATH_LENGTH) % PATH_LENGTH;

                  // Skip electrons near battery, bulb, and resistor
                  if (normalizedPos > 870 && normalizedPos < 930) return null;
                  if (normalizedPos > 370 && normalizedPos < 430) return null;
                  if (normalizedPos > 620 && normalizedPos < 680) return null;

                  const { x, y } = getCoordsOnPath(normalizedPos);
                  return (
                    <g key={electron.id} filter="url(#electronGlow)">
                      {/* Outer glow */}
                      <circle cx={x} cy={y} r="6" fill="#38bdf8" opacity="0.3" />
                      {/* Main electron */}
                      <circle cx={x} cy={y} r="4" fill="#38bdf8" />
                      {/* Inner highlight */}
                      <circle cx={x - 1} cy={y - 1} r="1.5" fill="#7dd3fc" opacity="0.8" />
                      {/* Minus sign */}
                      <text
                        x={x}
                        y={y}
                        textAnchor="middle"
                        dominantBaseline="central"
                        fill="#0c4a6e"
                        fontSize="6px"
                        fontWeight="bold"
                      >
                        ‚àí
                      </text>
                    </g>
                  );
              })}
            </>
          );
          };

          return (
            <div className="glass-card rounded-2xl p-6 w-full max-w-2xl">
              <h3 className="text-lg font-semibold text-slate-300 mb-4 flex items-center gap-2">
                <span className="text-cyan-400">‚ö°</span> Kopplingsschema
              </h3>
              <svg viewBox="0 0 400 300" className="w-full h-auto">
                {/* Background */}
                <rect x="0" y="0" width="400" height="300" fill="#050510" rx="8" />

                {/* Wire path with glow */}
                <path
                  d="M 50 50 H 350 V 250 H 50 Z"
                  fill="none"
                  stroke="#0ea5e9"
                  strokeWidth="4"
                  strokeLinecap="round"
                  className="wire-glow"
                  opacity="0.8"
                />

                {/* Brighter wire overlay */}
                <path
                  d="M 50 50 H 350 V 250 H 50 Z"
                  fill="none"
                  stroke="#38bdf8"
                  strokeWidth="2"
                  strokeLinecap="round"
                />

                {/* Current direction arrows - hidden when bulb is broken */}
                <g>
                    {showCurrentDirection && !isBulbBroken && <ArrowShapes />}
                </g>

                {/* Components */}
                <PowerSource />
                <Bulb />
                <Resistor />

                {/* Electrons - still visible but frozen when bulb is broken */}
                <g>
                    {showElectrons && <ElectronDots/>}
                </g>
              </svg>
            </div>
          );
        };

        const App = () => {
          const [circuitType, setCircuitType] = useState(CircuitType.DC);
          const [displayMode, setDisplayMode] = useState('current');
          const [voltage, setVoltage] = useState(12);
          const [resistance, setResistance] = useState(10);
          const [frequency, setFrequency] = useState(1.0);
          const [isPaused, setIsPaused] = useState(false);
          const [isBulbBroken, setIsBulbBroken] = useState(false);
          const [batteryFlipped, setBatteryFlipped] = useState(false);

          const current = voltage / resistance;

          // Break the bulb when current reaches 24 A
          useEffect(() => {
            if (current >= 24 && !isBulbBroken) {
              setIsBulbBroken(true);
            }
          }, [current, isBulbBroken]);

          const handleReplaceBulb = () => {
            setIsBulbBroken(false);
          };

          const handleSliderStyle = (value, min, max) => {
            const progress = ((value - min) / (max - min)) * 100;
            return { '--progress': `${progress}%` };
          };

          return (
            <div className="min-h-screen flex flex-col items-center py-8 px-4 gap-6 max-w-5xl mx-auto">

              {/* Header */}
              <header className="text-center space-y-3">
                <h1 className="text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-blue-400 to-cyan-400 tracking-tight glow-text">
                  Elektriska kretsar
                </h1>
                <p className="text-slate-400 max-w-2xl mx-auto leading-relaxed">
                  Utforska hur elektroner och str√∂m fl√∂dar i likstr√∂ms- och v√§xelstr√∂mskretsar.
                </p>
              </header>

              {/* Main content */}
              <div className="w-full grid grid-cols-1 lg:grid-cols-2 gap-6">

                {/* Left: Circuit Diagram */}
                <div className="flex flex-col gap-4">
                  <CircuitDiagram
                    circuitType={circuitType}
                    showElectrons={displayMode === 'electrons'}
                    showCurrentDirection={displayMode === 'current'}
                    currentStrength={current}
                    acFrequency={frequency}
                    isPaused={isPaused}
                    isBulbBroken={isBulbBroken}
                    batteryFlipped={batteryFlipped}
                    onBatteryClick={() => setBatteryFlipped(prev => !prev)}
                  />

                  {/* Info Box */}
                  <div className="glass-card p-5 rounded-xl">
                    <h3 className="text-lg font-semibold text-slate-200 mb-2">
                      {circuitType === CircuitType.DC ? '‚éì Likstr√∂m (DC)' : '‚àø V√§xelstr√∂m (AC)'}
                    </h3>
                    <p className="text-slate-400 text-sm leading-relaxed">
                      {circuitType === CircuitType.DC
                        ? 'I en likstr√∂mskrets fl√∂dar elektronerna kontinuerligt i samma riktning ‚Äì fr√•n minuspolen till pluspolen. Den konventionella str√∂mriktningen (I) √§r motsatt, fr√•n plus till minus. Batterier och solceller ger likstr√∂m.'
                        : 'I en v√§xelstr√∂mskrets byter elektronerna riktning m√•nga g√•nger per sekund i en oscillerande r√∂relse. De r√∂r sig fram och tillbaka, men √∂verf√∂r √§nd√• energi genom att "knuffa" p√• varandra. Eluttag i hemmet ger v√§xelstr√∂m (50 Hz).'}
                    </p>
                    {circuitType === CircuitType.DC && batteryFlipped && (
                      <p className="text-orange-400 text-sm mt-3 p-2 bg-orange-500/10 rounded-lg">
                        üîÑ Batteriet √§r v√§nt - str√∂mmen fl√∂dar nu √•t motsatt h√•ll!
                      </p>
                    )}
                  </div>
                </div>

                {/* Right: Controls */}
                <div className="flex flex-col gap-4">

                  {/* Circuit Type */}
                  <div className="glass-card p-4 rounded-xl">
                    <h3 className="text-sm font-medium text-slate-400 mb-3">Kretstyp</h3>
                    <div className="flex gap-3">
                      <button
                        onClick={() => setCircuitType(CircuitType.DC)}
                        className={`flex-1 px-4 py-3 rounded-xl font-medium transition-all ${
                          circuitType === CircuitType.DC
                            ? 'bg-cyan-500/30 text-cyan-300 border-2 border-cyan-400 btn-glow'
                            : 'bg-slate-800/50 text-slate-400 border border-slate-700 hover:border-slate-500'
                        }`}
                      >
                        ‚éì Likstr√∂m (DC)
                      </button>
                      <button
                        onClick={() => setCircuitType(CircuitType.AC)}
                        className={`flex-1 px-4 py-3 rounded-xl font-medium transition-all ${
                          circuitType === CircuitType.AC
                            ? 'bg-cyan-500/30 text-cyan-300 border-2 border-cyan-400 btn-glow'
                            : 'bg-slate-800/50 text-slate-400 border border-slate-700 hover:border-slate-500'
                        }`}
                      >
                        ‚àø V√§xelstr√∂m (AC)
                      </button>
                    </div>
                    {/* Flip battery button - only for DC */}
                    {circuitType === CircuitType.DC && (
                      <button
                        onClick={() => setBatteryFlipped(prev => !prev)}
                        className={`w-full mt-3 px-4 py-3 rounded-xl font-medium transition-all flex items-center justify-center gap-2 ${
                          batteryFlipped
                            ? 'bg-orange-500/30 text-orange-300 border-2 border-orange-400'
                            : 'bg-slate-800/50 text-slate-400 border border-slate-700 hover:border-slate-500'
                        }`}
                      >
                        üîÑ V√§nd batteri {batteryFlipped ? '(v√§nt)' : ''}
                      </button>
                    )}
                  </div>

                  {/* Display Mode */}
                  <div className="glass-card p-4 rounded-xl">
                    <h3 className="text-sm font-medium text-slate-400 mb-3">Visningsl√§ge</h3>
                    <div className="flex gap-3">
                      <button
                        onClick={() => setDisplayMode('current')}
                        className={`flex-1 px-4 py-3 rounded-xl font-medium transition-all ${
                          displayMode === 'current'
                            ? 'bg-cyan-500/30 text-cyan-300 border-2 border-cyan-400 btn-glow'
                            : 'bg-slate-800/50 text-slate-400 border border-slate-700 hover:border-slate-500'
                        }`}
                      >
                        ‚Üí Str√∂mriktning
                      </button>
                      <button
                        onClick={() => setDisplayMode('electrons')}
                        className={`flex-1 px-4 py-3 rounded-xl font-medium transition-all ${
                          displayMode === 'electrons'
                            ? 'bg-cyan-500/30 text-cyan-300 border-2 border-cyan-400 btn-glow'
                            : 'bg-slate-800/50 text-slate-400 border border-slate-700 hover:border-slate-500'
                        }`}
                      >
                        ‚óè Elektroner
                      </button>
                    </div>
                  </div>

                  {/* Parameters */}
                  <div className="glass-card p-4 rounded-xl">
                    <h3 className="text-sm font-medium text-slate-400 mb-4">Kretsparametrar</h3>

                    <div className="space-y-5">
                      {/* Voltage */}
                      <div>
                        <div className="flex justify-between items-center mb-2">
                          <label className="text-slate-300">Sp√§nning (U)</label>
                          <span className="font-mono text-cyan-400 bg-slate-800 px-2 py-1 rounded">
                            {voltage} V
                          </span>
                        </div>
                        <input
                          type="range"
                          min="1"
                          max="24"
                          step="1"
                          value={voltage}
                          onChange={(e) => setVoltage(parseFloat(e.target.value))}
                          className="w-full cursor-pointer"
                          style={handleSliderStyle(voltage, 1, 24)}
                        />
                      </div>

                      {/* Resistance */}
                      <div>
                        <div className="flex justify-between items-center mb-2">
                          <label className="text-slate-300">Resistans (R)</label>
                          <span className="font-mono text-cyan-400 bg-slate-800 px-2 py-1 rounded">
                            {resistance} Œ©
                          </span>
                        </div>
                        <input
                          type="range"
                          min="1"
                          max="50"
                          step="1"
                          value={resistance}
                          onChange={(e) => setResistance(parseFloat(e.target.value))}
                          className="w-full cursor-pointer"
                          style={handleSliderStyle(resistance, 1, 50)}
                        />
                      </div>

                      {/* AC Frequency */}
                      {circuitType === CircuitType.AC && (
                        <div>
                          <div className="flex justify-between items-center mb-2">
                            <label className="text-slate-300">Frekvens (f)</label>
                            <span className="font-mono text-cyan-400 bg-slate-800 px-2 py-1 rounded">
                              {frequency.toFixed(1).replace('.', ',')} Hz
                            </span>
                          </div>
                          <input
                            type="range"
                            min="0.2"
                            max="5"
                            step="0.1"
                            value={frequency}
                            onChange={(e) => setFrequency(parseFloat(e.target.value))}
                            className="w-full cursor-pointer"
                            style={handleSliderStyle(frequency, 0.2, 5)}
                          />
                        </div>
                      )}
                    </div>
                  </div>

                  {/* Current Display & Controls */}
                  <div className="glass-card p-4 rounded-xl">
                    <div className="flex items-center justify-between mb-4">
                      <div>
                        <div className="text-sm text-slate-400">Str√∂mstyrka (I = U/R)</div>
                        <div className={`text-3xl font-mono font-bold ${isBulbBroken ? 'text-red-400' : 'text-yellow-400'}`}>
                          {current.toFixed(2).replace('.', ',')} A
                        </div>
                      </div>
                      <button
                        onClick={() => setIsPaused(prev => !prev)}
                        className={`px-6 py-3 rounded-xl font-bold transition-all ${
                          isPaused
                            ? 'bg-green-500 text-white hover:bg-green-600'
                            : 'bg-orange-500 text-white hover:bg-orange-600'
                        }`}
                      >
                        {isPaused ? '‚ñ∂ Starta' : '‚è∏ Pausa'}
                      </button>
                    </div>
                    {isBulbBroken && (
                      <div className="mt-3 p-3 bg-red-500/20 border border-red-500/50 rounded-lg">
                        <div className="text-red-400 font-semibold text-center mb-3">‚ö†Ô∏è Lampan har g√•tt s√∂nder! Kretsen √§r bruten.</div>
                        <button
                          onClick={handleReplaceBulb}
                          className="w-full px-4 py-2 bg-cyan-600 hover:bg-cyan-500 text-white font-semibold rounded-lg transition-all"
                        >
                          üí° Byt ut lampan
                        </button>
                      </div>
                    )}
                  </div>
                </div>
              </div>

              {/* Ohms Law */}
              <div className="w-full glass-card p-6 rounded-2xl">
                <h2 className="text-xl font-bold text-slate-200 mb-4">Ohms lag</h2>
                <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
                  <div className="text-center p-4 bg-slate-800/50 rounded-xl">
                    <div className="text-4xl font-mono font-bold text-cyan-400 mb-2">U = R ¬∑ I</div>
                    <div className="text-slate-400 text-sm">Sp√§nning = Resistans √ó Str√∂m</div>
                  </div>
                  <div className="text-center p-4 bg-slate-800/50 rounded-xl">
                    <div className="text-4xl font-mono font-bold text-green-400 mb-2 flex items-center justify-center gap-2">
                      <span>I</span>
                      <span>=</span>
                      <span className="inline-flex flex-col items-center">
                        <span className="border-b-2 border-green-400 px-2">U</span>
                        <span className="px-2">R</span>
                      </span>
                    </div>
                    <div className="text-slate-400 text-sm">Str√∂m = Sp√§nning / Resistans</div>
                  </div>
                  <div className="text-center p-4 bg-slate-800/50 rounded-xl">
                    <div className="text-4xl font-mono font-bold text-orange-400 mb-2 flex items-center justify-center gap-2">
                      <span>R</span>
                      <span>=</span>
                      <span className="inline-flex flex-col items-center">
                        <span className="border-b-2 border-orange-400 px-2">U</span>
                        <span className="px-2">I</span>
                      </span>
                    </div>
                    <div className="text-slate-400 text-sm">Resistans = Sp√§nning / Str√∂m</div>
                  </div>
                </div>
              </div>

            </div>
          );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
