<!DOCTYPE html>
<html lang="sv">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Magnetisk Kraft p√• Ledare</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      ::-webkit-scrollbar {
        width: 8px;
      }
      ::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.1);
      }
      ::-webkit-scrollbar-thumb {
        background: rgba(255, 255, 255, 0.2);
        border-radius: 4px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: rgba(255, 255, 255, 0.4);
      }
    </style>
    <script type="importmap">
{
  "imports": {
    "react/": "https://esm.sh/react@18.2.0/",
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/": "https://esm.sh/react-dom@18.2.0/",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "@react-three/fiber": "https://esm.sh/@react-three/fiber@8.9.0",
    "@react-three/drei": "https://esm.sh/@react-three/drei@9.56.0",
    "three": "https://esm.sh/three@0.149.0",
    "three/": "https://esm.sh/three@0.149.0/"
  }
}
    </script>
</head>
<body class="bg-slate-900 text-white overflow-hidden" style="margin: 0; padding: 0;">
    <div id="root"></div>
    <script type="module">
import React, { useState, useCallback, useRef, useMemo, Suspense, useEffect } from "react";
import { createRoot } from "react-dom/client";
import { Canvas, useFrame } from "@react-three/fiber";
import { OrbitControls, Stars, Text } from "@react-three/drei";
import * as THREE from "three";

const FIELD_COLOR = "#3b82f6";
const FORCE_COLOR = "#22c55e";
const CURRENT_COLOR = "#ef4444";

// Horseshoe magnet component
const Magnet = ({ flipped, showLabels, fieldStrength }) => {
  const magnetColor = "#64748b";
  const northColor = "#ef4444";
  const southColor = "#3b82f6";

  const poleWidth = 1.2;
  const poleHeight = 2.5;
  const poleDepth = 0.8;
  const baseWidth = 5;
  const baseHeight = 0.6;

  return React.createElement("group", { rotation: [0, flipped ? Math.PI : 0, 0] },
    // Left pole (North)
    React.createElement("mesh", { position: [-baseWidth/2 + poleWidth/2, poleHeight/2 - baseHeight/2, 0] },
      React.createElement("boxGeometry", { args: [poleWidth, poleHeight, poleDepth] }),
      React.createElement("meshStandardMaterial", { color: magnetColor, metalness: 0.5, roughness: 0.3 })
    ),
    // Right pole (South)
    React.createElement("mesh", { position: [baseWidth/2 - poleWidth/2, poleHeight/2 - baseHeight/2, 0] },
      React.createElement("boxGeometry", { args: [poleWidth, poleHeight, poleDepth] }),
      React.createElement("meshStandardMaterial", { color: magnetColor, metalness: 0.5, roughness: 0.3 })
    ),
    // Base
    React.createElement("mesh", { position: [0, poleHeight - baseHeight/2, 0] },
      React.createElement("boxGeometry", { args: [baseWidth, baseHeight, poleDepth] }),
      React.createElement("meshStandardMaterial", { color: magnetColor, metalness: 0.5, roughness: 0.3 })
    ),
    // North pole face
    React.createElement("mesh", { position: [-baseWidth/2 + poleWidth/2, -0.8, poleDepth/2 + 0.01] },
      React.createElement("planeGeometry", { args: [0.8, 0.8] }),
      React.createElement("meshBasicMaterial", { color: northColor })
    ),
    showLabels && React.createElement(Text, {
      position: [-baseWidth/2 + poleWidth/2, -0.8, poleDepth/2 + 0.05],
      fontSize: 0.5,
      color: "white",
      fontWeight: "bold",
      anchorX: "center",
      anchorY: "middle"
    }, "N"),
    // South pole face
    React.createElement("mesh", { position: [baseWidth/2 - poleWidth/2, -0.8, poleDepth/2 + 0.01] },
      React.createElement("planeGeometry", { args: [0.8, 0.8] }),
      React.createElement("meshBasicMaterial", { color: southColor })
    ),
    showLabels && React.createElement(Text, {
      position: [baseWidth/2 - poleWidth/2, -0.8, poleDepth/2 + 0.05],
      fontSize: 0.5,
      color: "white",
      fontWeight: "bold",
      anchorX: "center",
      anchorY: "middle"
    }, "S")
  );
};

// Field lines between magnet poles
const FieldLines = ({ showLines, showLabels, fieldStrength }) => {
  if (!showLines) return null;

  const numLines = 8;
  const spacing = 3.2;
  const lineLength = 3.6;

  return React.createElement("group", { position: [0, -0.5, 0] },
    Array.from({ length: numLines }).map((_, i) => {
      const y = (i - numLines/2 + 0.5) * 0.35;
      const curve = Math.abs(y) * 0.15;

      return React.createElement("mesh", {
        key: `field-${i}`,
        position: [0, y, 0],
        rotation: [0, 0, 0]
      },
        React.createElement("capsuleGeometry", { args: [0.02, lineLength, 8, 16], rotation: [0, 0, Math.PI / 2] }),
        React.createElement("meshStandardMaterial", {
          color: FIELD_COLOR,
          emissive: FIELD_COLOR,
          emissiveIntensity: 0.5 * fieldStrength,
          transparent: true,
          opacity: 0.6
        })
      );
    }),
    showLabels && React.createElement(Text, {
      position: [0, 1.5, 0],
      fontSize: 0.5,
      color: FIELD_COLOR,
      fontStyle: "italic",
      anchorX: "center",
      anchorY: "middle"
    }, "B")
  );
};

// Swinging conductor on wires
const SwingingConductor = ({ currentStrength, currentDirection, force, showLabels }) => {
  const conductorRef = useRef(null);
  const swingAngle = force * 0.3;

  useFrame((state) => {
    if (conductorRef.current) {
      const t = state.clock.getElapsedTime();
      const targetAngle = swingAngle * Math.sin(t * 1.5);
      conductorRef.current.rotation.z = THREE.MathUtils.lerp(conductorRef.current.rotation.z, targetAngle, 0.1);
    }
  });

  const wireLength = 2;
  const conductorLength = 2.5;
  const conductorRadius = 0.08;

  return React.createElement("group", { ref: conductorRef, position: [0, 1.5, 0] },
    // Left wire
    React.createElement("mesh", { position: [-conductorLength/2, wireLength/2, 0] },
      React.createElement("cylinderGeometry", { args: [0.02, 0.02, wireLength, 8] }),
      React.createElement("meshStandardMaterial", { color: "#94a3b8" })
    ),
    // Right wire
    React.createElement("mesh", { position: [conductorLength/2, wireLength/2, 0] },
      React.createElement("cylinderGeometry", { args: [0.02, 0.02, wireLength, 8] }),
      React.createElement("meshStandardMaterial", { color: "#94a3b8" })
    ),
    // Conductor bar
    React.createElement("mesh", { position: [0, 0, 0], rotation: [0, 0, Math.PI / 2] },
      React.createElement("cylinderGeometry", { args: [conductorRadius, conductorRadius, conductorLength, 16] }),
      React.createElement("meshStandardMaterial", {
        color: "#f59e0b",
        metalness: 0.7,
        roughness: 0.3
      })
    ),
    // Current arrow
    currentStrength > 0 && React.createElement("group", {
      position: [0, 0, 0],
      rotation: [0, 0, currentDirection === 1 ? 0 : Math.PI]
    },
      React.createElement("mesh", { position: [0.4, 0, 0] },
        React.createElement("cylinderGeometry", { args: [0.06, 0.06, 0.6, 8], rotation: [0, 0, Math.PI / 2] }),
        React.createElement("meshStandardMaterial", {
          color: CURRENT_COLOR,
          emissive: CURRENT_COLOR,
          emissiveIntensity: 0.6
        })
      ),
      React.createElement("mesh", { position: [0.85, 0, 0], rotation: [0, 0, -Math.PI / 2] },
        React.createElement("coneGeometry", { args: [0.12, 0.3, 16] }),
        React.createElement("meshStandardMaterial", {
          color: CURRENT_COLOR,
          emissive: CURRENT_COLOR,
          emissiveIntensity: 0.6
        })
      ),
      showLabels && React.createElement(Text, {
        position: [0.4, -0.25, 0],
        fontSize: 0.4,
        color: CURRENT_COLOR,
        fontStyle: "italic",
        anchorX: "center",
        anchorY: "top"
      }, "I")
    ),
    // Force arrow (perpendicular to current and field)
    force > 0 && React.createElement("group", { position: [0, 0, 0.5] },
      React.createElement("mesh", { position: [0, 0, 0.3] },
        React.createElement("cylinderGeometry", { args: [0.06, 0.06, 0.6 * force, 8] }),
        React.createElement("meshStandardMaterial", {
          color: FORCE_COLOR,
          emissive: FORCE_COLOR,
          emissiveIntensity: 0.8
        })
      ),
      React.createElement("mesh", { position: [0, 0.3 * force + 0.15, 0.3] },
        React.createElement("coneGeometry", { args: [0.12, 0.3, 16] }),
        React.createElement("meshStandardMaterial", {
          color: FORCE_COLOR,
          emissive: FORCE_COLOR,
          emissiveIntensity: 0.8
        })
      ),
      showLabels && React.createElement(Text, {
        position: [0.25, 0.3 * force, 0.3],
        fontSize: 0.4,
        color: FORCE_COLOR,
        fontWeight: "bold",
        anchorX: "left",
        anchorY: "middle"
      }, "F")
    )
  );
};

// Animated electrons flowing through conductor
const Electrons = ({ currentStrength, currentDirection, showElectrons }) => {
  const electronsRef = useRef([]);
  const numElectrons = 12;

  useFrame((state) => {
    if (!showElectrons || currentStrength === 0) return;

    const t = state.clock.getElapsedTime();
    electronsRef.current.forEach((electron, i) => {
      if (electron) {
        const offset = (i / numElectrons) * 2.5;
        const pos = ((t * currentStrength * 0.5 * currentDirection + offset) % 2.5) - 1.25;
        electron.position.x = pos;
      }
    });
  });

  if (!showElectrons || currentStrength === 0) return null;

  return React.createElement("group", { position: [0, 1.5, 0] },
    Array.from({ length: numElectrons }).map((_, i) =>
      React.createElement("mesh", {
        key: `electron-${i}`,
        ref: el => electronsRef.current[i] = el,
        position: [0, 0, 0]
      },
        React.createElement("sphereGeometry", { args: [0.06, 16, 16] }),
        React.createElement("meshStandardMaterial", {
          color: "#60a5fa",
          emissive: "#60a5fa",
          emissiveIntensity: 1
        })
      )
    )
  );
};

const Scene = ({
  currentStrength,
  currentDirection,
  fieldStrength,
  magnetFlipped,
  showFieldLines,
  showLabels,
  showElectrons
}) => {
  const force = currentStrength * fieldStrength;

  return React.createElement(Canvas, {
    shadows: true,
    camera: { position: [6, 3, 8], fov: 50 },
    style: { width: "100%", height: "100%" }
  },
    React.createElement("color", { attach: "background", args: ["#0f172a"] }),
    React.createElement("ambientLight", { intensity: 0.5 }),
    React.createElement("directionalLight", { position: [10, 10, 5], intensity: 1, castShadow: true }),
    React.createElement("pointLight", { position: [-10, -10, -5], intensity: 0.5, color: "#818cf8" }),
    React.createElement(Suspense, { fallback: null },
      React.createElement(Stars, { radius: 100, depth: 50, count: 5000, factor: 4, saturation: 0, fade: true, speed: 1 })
    ),
    React.createElement("group", { position: [0, -1, 0] },
      React.createElement(Magnet, {
        flipped: magnetFlipped,
        showLabels: showLabels,
        fieldStrength: fieldStrength
      }),
      React.createElement(FieldLines, {
        showLines: showFieldLines,
        showLabels: showLabels,
        fieldStrength: fieldStrength
      }),
      React.createElement(SwingingConductor, {
        currentStrength: currentStrength,
        currentDirection: currentDirection,
        force: force,
        showLabels: showLabels
      }),
      React.createElement(Electrons, {
        currentStrength: currentStrength,
        currentDirection: currentDirection,
        showElectrons: showElectrons
      })
    ),
    React.createElement(OrbitControls, {
      makeDefault: true,
      minPolarAngle: 0,
      maxPolarAngle: Math.PI / 1.5,
      minDistance: 4,
      maxDistance: 20
    })
  );
};

const UIControls = ({
  currentStrength,
  currentDirection,
  fieldStrength,
  magnetFlipped,
  showFieldLines,
  showLabels,
  showElectrons,
  setCurrentStrength,
  toggleCurrentDirection,
  setFieldStrength,
  toggleMagnetFlip,
  toggleFieldLines,
  toggleLabels,
  toggleElectrons
}) => {
  const force = (currentStrength * fieldStrength).toFixed(2);

  return React.createElement("div", {
    className: "absolute top-4 left-4 md:top-8 md:left-8 z-10 max-w-sm w-full"
  },
    React.createElement("div", {
      className: "bg-slate-800/90 backdrop-blur-md border border-slate-700 rounded-xl p-6 shadow-2xl text-slate-100"
    },
      React.createElement("h1", {
        className: "text-xl font-bold mb-1 bg-gradient-to-r from-green-400 to-emerald-300 bg-clip-text text-transparent"
      }, "Magnetisk Kraft p√• Ledare"),
      React.createElement("p", { className: "text-slate-400 text-sm mb-6" },
        "Lorentzkraft: F = I ¬∑ L √ó B"
      ),

      // Current strength slider
      React.createElement("div", { className: "space-y-2 mb-4" },
        React.createElement("label", {
          className: "text-xs font-semibold text-slate-400 uppercase tracking-wider flex justify-between"
        },
          React.createElement("span", null, "Str√∂mstyrka (I)"),
          React.createElement("span", { className: "text-red-400" }, currentStrength.toFixed(1) + " A")
        ),
        React.createElement("input", {
          type: "range",
          min: "0",
          max: "10",
          step: "0.5",
          value: currentStrength,
          onChange: (e) => setCurrentStrength(parseFloat(e.target.value)),
          className: "w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-red-500"
        })
      ),

      // Current direction button
      React.createElement("div", { className: "space-y-2 mb-4" },
        React.createElement("label", {
          className: "text-xs font-semibold text-slate-400 uppercase tracking-wider"
        }, "Str√∂mriktning"),
        React.createElement("button", {
          onClick: toggleCurrentDirection,
          className: "w-full flex items-center justify-between px-4 py-3 rounded-lg transition-all duration-300 font-medium " + (
            currentDirection === 1
              ? "bg-red-500/20 border border-red-500/50 text-red-200 hover:bg-red-500/30"
              : "bg-blue-500/20 border border-blue-500/50 text-blue-200 hover:bg-blue-500/30"
          )
        },
          React.createElement("span", null, currentDirection === 1 ? "‚Üí H√∂ger" : "‚Üê V√§nster")
        )
      ),

      // Field strength slider
      React.createElement("div", { className: "space-y-2 mb-4" },
        React.createElement("label", {
          className: "text-xs font-semibold text-slate-400 uppercase tracking-wider flex justify-between"
        },
          React.createElement("span", null, "Magnetf√§lt (B)"),
          React.createElement("span", { className: "text-blue-400" }, fieldStrength.toFixed(1) + " T")
        ),
        React.createElement("input", {
          type: "range",
          min: "0",
          max: "2",
          step: "0.1",
          value: fieldStrength,
          onChange: (e) => setFieldStrength(parseFloat(e.target.value)),
          className: "w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"
        })
      ),

      // Magnet flip button
      React.createElement("div", { className: "space-y-2 mb-4" },
        React.createElement("button", {
          onClick: toggleMagnetFlip,
          className: "w-full px-4 py-3 rounded-lg transition-all duration-300 font-medium bg-purple-500/20 border border-purple-500/50 text-purple-200 hover:bg-purple-500/30"
        },
          React.createElement("span", null, "üîÑ V√§nd magnet (N ‚áÑ S)")
        )
      ),

      // Force display
      React.createElement("div", {
        className: "p-4 rounded-lg bg-green-500/10 border border-green-500/30 mb-4"
      },
        React.createElement("div", { className: "text-xs text-green-400 uppercase tracking-wider mb-1" }, "Kraft p√• ledare"),
        React.createElement("div", { className: "text-2xl font-bold text-green-300" },
          "F = " + force + " N"
        )
      ),

      // Visualization toggles
      React.createElement("div", { className: "space-y-2" },
        React.createElement("label", {
          className: "text-xs font-semibold text-slate-400 uppercase tracking-wider"
        }, "Visualisering"),
        React.createElement("div", {
          className: "flex items-center justify-between p-3 rounded-lg bg-slate-700/30 hover:bg-slate-700/50 transition-colors cursor-pointer",
          onClick: toggleFieldLines
        },
          React.createElement("span", { className: "text-sm" }, "Visa magnetf√§ltlinjer"),
          React.createElement("div", {
            className: "w-5 h-5 rounded border flex items-center justify-center transition-colors " + (
              showFieldLines ? "bg-blue-500 border-blue-500" : "border-slate-500"
            )
          }, showFieldLines && "‚úì")
        ),
        React.createElement("div", {
          className: "flex items-center justify-between p-3 rounded-lg bg-slate-700/30 hover:bg-slate-700/50 transition-colors cursor-pointer",
          onClick: toggleElectrons
        },
          React.createElement("span", { className: "text-sm" }, "Visa elektroner"),
          React.createElement("div", {
            className: "w-5 h-5 rounded border flex items-center justify-center transition-colors " + (
              showElectrons ? "bg-cyan-500 border-cyan-500" : "border-slate-500"
            )
          }, showElectrons && "‚úì")
        ),
        React.createElement("div", {
          className: "flex items-center justify-between p-3 rounded-lg bg-slate-700/30 hover:bg-slate-700/50 transition-colors cursor-pointer",
          onClick: toggleLabels
        },
          React.createElement("span", { className: "text-sm" }, "Visa beteckningar (I, B, F)"),
          React.createElement("div", {
            className: "w-5 h-5 rounded border flex items-center justify-center transition-colors " + (
              showLabels ? "bg-purple-500 border-purple-500" : "border-slate-500"
            )
          }, showLabels && "‚úì")
        )
      ),

      // Info box
      React.createElement("div", {
        className: "mt-6 pt-4 border-t border-slate-700/50 flex gap-3 items-start text-xs text-slate-400"
      },
        React.createElement("span", { className: "text-blue-400" }, "‚Ñπ"),
        React.createElement("p", null,
          "Kraften beror p√• str√∂mstyrkan, magnetf√§ltet och deras inb√∂rdes riktningar. Anv√§nd ",
          React.createElement("strong", null, "h√∂gerhandsregeln"),
          " f√∂r att best√§mma kraftens riktning!"
        )
      )
    )
  );
};

const App = () => {
  const [currentStrength, setCurrentStrength] = useState(5);
  const [currentDirection, setCurrentDirection] = useState(1);
  const [fieldStrength, setFieldStrength] = useState(1);
  const [magnetFlipped, setMagnetFlipped] = useState(false);
  const [showFieldLines, setShowFieldLines] = useState(true);
  const [showLabels, setShowLabels] = useState(false);
  const [showElectrons, setShowElectrons] = useState(false);

  const toggleCurrentDirection = useCallback(() => {
    setCurrentDirection(prev => prev === 1 ? -1 : 1);
  }, []);

  const toggleMagnetFlip = useCallback(() => {
    setMagnetFlipped(prev => !prev);
  }, []);

  const toggleFieldLines = useCallback(() => {
    setShowFieldLines(prev => !prev);
  }, []);

  const toggleLabels = useCallback(() => {
    setShowLabels(prev => !prev);
  }, []);

  const toggleElectrons = useCallback(() => {
    setShowElectrons(prev => !prev);
  }, []);

  return React.createElement("div", {
    className: "relative w-screen h-screen bg-slate-900"
  },
    React.createElement(Scene, {
      currentStrength: currentStrength,
      currentDirection: currentDirection,
      fieldStrength: fieldStrength,
      magnetFlipped: magnetFlipped,
      showFieldLines: showFieldLines,
      showLabels: showLabels,
      showElectrons: showElectrons
    }),
    React.createElement(UIControls, {
      currentStrength: currentStrength,
      currentDirection: currentDirection,
      fieldStrength: fieldStrength,
      magnetFlipped: magnetFlipped,
      showFieldLines: showFieldLines,
      showLabels: showLabels,
      showElectrons: showElectrons,
      setCurrentStrength: setCurrentStrength,
      toggleCurrentDirection: toggleCurrentDirection,
      setFieldStrength: setFieldStrength,
      toggleMagnetFlip: toggleMagnetFlip,
      toggleFieldLines: toggleFieldLines,
      toggleLabels: toggleLabels,
      toggleElectrons: toggleElectrons
    }),
    React.createElement("div", {
      className: "absolute bottom-4 right-4 text-slate-500 text-xs pointer-events-none select-none"
    }, "Interaktiv Fysik ‚Ä¢ React Three Fiber")
  );
};

const rootElement = document.getElementById("root");
if (rootElement) {
  const root = createRoot(rootElement);
  root.render(React.createElement(App));
}
    </script>
</body>
</html>
